---
title: "Fitting a Zeta distribution to a P survey&mdash;number of groups data"
output: rmarkdown::html_vignette
bibliography: '`r system.file("REFERENCES.bib", package="fitPS")`'
vignette: >
  %\VignetteIndexEntry{Fitting a Zeta distribution to a P survey&mdash;number of groups data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
suppressWarnings(suppressPackageStartupMessages({library(fitPS)}))
```

In this example we will learn how to use `fitPS` to fit a Zeta distribution to some data from a survey where the number of groups of glass found is recorded. The data in this example comes from @roux2001 who surveyed the footwear of 776 individuals in south-eastern Australia, and is summarised in the table below.
```{r results='asis', echo=FALSE}
knitr::kable(Psurveys$roux$data, 
             col.names = c("$n$", "$r_n$"),
             align = "rr")
```
This data set is built into the package and can be accessed from the `Psurveys` object. That is, we can type:
```{r}
roux = Psurveys$roux
```
The data is stored as an object of class `psData`. This probably will not be of importance to most users. If you are interested in the details, then these can be found in the **Value** section of the help page for `readData`. There is an S3 `print` method for objects of time, meaning that if we print the object---either by typing its name at the command prompt, or by explicitly calling `print`---then we will get formatted printing of the information contained within the object. Specifically:

  * the values of $n$ and $r_n$ will be printed out in tabular format (where $n$ is the number of groups or the size of the groups, and $r_n$ is the number of times $n$ has been observed in the survey), 
  * the type of survey will be printed---either "Number of Groups" or "Group Size",
  * and if the object has a reference or notes attached to it, then these will be 
  printed as well

For example
```{r}
roux
```

It is very simple to fit a Zeta distribution to this data set. We do this using the `fitDist` function. 
```{r}
fit = fitDist(roux)
```
The function returns an object of class `psFit`, the details of which can be found in the help page for `fitDist`. There are both S3 `print` and S3 `plot` methods for objects of this
class. The `print` method method displays an estimate of the shape parameter $s$, an estimate of the standard deviation---the standard error---of the estimate of $s$ ($\widehat{\mathrm{sd}}(\hat{s})=\mathrm{se}(\hat{s})$). **NOTE**: it is important to understand that the value of the shape parameter that is displayed, and the value that is stored in the fitted object differ by 1. That is, $s$ is shown,m and $s^\prime = s - 1$ is stored. This is done because the package which assists in the fitting, `VGAM`, is parameterised in terms of $s^\prime$. This difference only has consequences if the fitted value is being used in conjuction with other `VGAM` functions.   The `print` method also displays the first 10 fitted probabilities from the model by default. The number of probabilities shown can be altered by changing the value of `nterms`. We will do this here to only display the first six probabilities (from $P_0$ to $P_5$).
```{r}
print(fit, nterms = 6)
```
The package provides a `confint` method for the fitted value. The method returns both a Wald confidence interval and profile likelihood interval. The Wald interval takes the usual the form where the lower and upper bound are given by $\hat{s} \pm z^*(1-\alpha/2)\times se(\hat{s}))$. The profile likelihood interval finds the end-points of the interval that satisfies
\[
-2\left[\ell(\hat{s};\mathbf{x})-\ell(s;\mathbf{x})\right] \le \chi^2_1(\alpha)
\]
where $\ell(s;\mathbf{x})$ is value of the log-likelihood given shape parameter $s$. The two intervals are returned as elements of a `list` named `wald` and `prof` respectively.
```{r}
ci = confint(fit)
ci$wald
ci$prof
```
You will notice that neither of these intervals contain the value shown in the previous output. However, this simply because they are confidence intervals on $s^\prime$ and not $s$. This can be remedied by adding one to each interval:
```{r}
ci$wald + 1
ci$prof + 1
```
The reason for not *correcting* these intervals is that the method mostly exists to feed into other parts of the package, especially the `plot` method. 



